---
import { isMobile } from 'mobile-device-detect';
---

<dialog id="recommendation-confirmation" class="modal modal-bottom sm:modal-middle bg-page">
  <div class="modal-box">
    <form class="close-form" method="dialog">
      <button class="btn-close btn btn-sm btn-circle btn-ghost absolute right-2 top-2" style="line-height:0.3">âœ•</button
      >
    </form>
    <div class="flex flex-col h-full mt-4">
      <header class="modal-header flex flex-col">
        <h3 class="text-2xl font-bold">Thank you!</h3>
        <p>
          Thank you for your recommendation. Since you have come this far, would you be willing to post this to
          LinkedIn?
        </p>
        <p class="mt-4">
          Just click this link, and you should be redirected to the recommendation form. Your recommendation will be in
          your clipboard and can be pasted in using CTRL+V (CMD+V)
        </p>
      </header>
      <button id="recomendation-linkedin" class="btn btn-primary mt-4">Share on LinkedIn</button>
    </div>
  </div>
</dialog>
<form method="dialog" class="modal-backdrop">
  <button>close</button>
</form>

<script>
  console.log('is mobile', isMobile);
  const shareLink = isMobile
    ? 'https://www.linkedin.com/in/nikchanda'
    : 'https://www.linkedin.com/in/nikchanda/edit/forms/recommendation/write/?profileFormEntryPoint=PROFILE_SECTION&profileUrn=urn%3Ali%3Afsd_profile%3AACoAAAAQowIBGVKfFY3lmtvgHAF1kyh4TSUlWmg&trackingId=o4FF%2FFuqRuytRxw7VW2mqg%3D%3D';

  const copyOperation = async (text) => {
    await navigator.clipboard.writeText(text);
    console.log('Copy Success!');
  };

  // LinkedIn Share Button
  const shareBtn = document.getElementById('recomendation-linkedin');
  shareBtn.addEventListener('click', async (e) => {
    e.preventDefault();

    const recommendation = document.getElementById('recommendation');
    const value = recommendation.value ? recommendation.value : recommendation.innerHTML;

    await copyOperation(value);
    window.open(shareLink, '_blank');
  });
</script>
