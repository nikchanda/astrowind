---
import Steps from '~/components/widgets/Steps.astro';
import { education, certification } from '~/content/cv/education';
import { Icon } from 'astro-icon/components';

const { cv = '' } = Astro.props;
const blogroot = `/blog/tag`;

const formatEduItems = (cv) => {
  let items = [];
  for (const row of education) {
    if ('undefined' != typeof row.applies && row.applies.indexOf(cv) == -1) {
      continue;
    }
    let institution = `${row.institution}`;
    if (row.department) {
      institution += `<br/>${row.department}`;
    }
    let title = `${row.degree} in<br/>${row.subject}<br/><span class="font-normal">${institution}</span>`;
    if (row.date) {
      title += `<br/><span class="text-sm font-normal">${row.date}</span>`;
    }

    items.push({ title, icon: 'tabler:school' });
  }
  return items;
};
const formatCertItems = (cv) => {
  let items = [];
  for (const row of certification) {
    if ('undefined' != typeof row.applies && row.applies.indexOf(cv) == -1) {
      continue;
    }
    let title = `${row.title}<br/><span class="font-normal">${row.issuer}</span>`;
    if (row.date) {
      title += `<br/><span class="text-sm font-normal">${row.date}</span>`;
    }

    let desc = '';
    if (row.cases) {
      desc = '<footer class="mt-5"><ul class="text-sm">';
      if (row.link) {
        desc += `<li class="bg-gray-100 dark:bg-slate-700 inline-block mr-2 rtl:mr-0 rtl:ml-2 mb-2 py-0.5 px-2 lowercase font-medium"><a href=${row.link} target='_blank' class="text-muted dark:text-slate-300 hover:text-primary dark:hover:text-gray-200">certificate</a></li>`;
      }
      if (row.blog) {
        desc += `<li class="bg-gray-100 dark:bg-slate-700 inline-block mr-2 rtl:mr-0 rtl:ml-2 mb-2 py-0.5 px-2 lowercase font-medium"><a href="${blogroot}/${row.blog}" class="text-muted dark:text-slate-300 hover:text-primary dark:hover:text-gray-200">blog</a></li>`;
      }
      desc += '</ul></footer>';
    }

    items.push({ title, description: desc, icon: 'tabler:school' });
  }
  return items;
};
---

<section id="education">
  <Steps id="education-widget-1" title="Education" items={formatEduItems()} classes={{ container: 'max-w-3xl' }} />
  <Steps
    id="education-widget-2"
    title="Certifications"
    items={formatCertItems()}
    classes={{ container: 'max-w-3xl' }}
  />
</section>
